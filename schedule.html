<html>
<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

</head>

<body>

<!-- okay let's break this down
	the first thing we need is a dropdown for the ventures so that they are able to choose
	then we need to query all the info we need
	display it all
	add breaks

-->

<!-- do all to lowercase first, before querying-->

<select id="venture">

<option value="A&K Robotics" >A&#38K Robotics</option>
<option value="Acerta" > Acerta</option>
<option value="Ada">Ada</option>
<option value="Aerial" >Aerial</option>
<option value="Automat" >Automat</option>
<option value="Bridge Genomics" >Bridge Genomics</option>
<option value="Cohesic" >Cohesic</option>
<option value="Datalogue" >Datalogue</option>
<option value="Dat-uh" >Dat-uh</option>
<option value="Deep Diagnostics" >Deep Diagnostics</option>
<option value="Diligen" >Diligen</option>
<option value="DOCTO">DOCTO</option>
<option value="Feo">Feo</option>
<option value="Fluent.ai" >Fluent.ai</option>
<option value="FREDsense" >FREDsense</option>
<option value="Fundmetric" >Fundmetric</option>
<option value="Gbatteries" >Gbatteries</option>
<option value="H2nanO" >H2nanO</option>
<option value="ICSPI" selected="selected">ICSPI</option>
<option value="Knote" >Knote</option>
<option value="Kyndi" >Kyndi</option>
<option value="Elucid Labs" >Elucid Labs</option>
<option value="MashUp Machine" >MashUp Machine</option>
<option value="MedStack" >MedStack</option>
<option value="MIMOSA" >MIMOSA</option>
<option value="MyHEAT" >MYHEAT</option>
<option value="Galaxy.Ai" >Galaxy.Ai</option>
<option value="Nix Sensor" >Nix Sensor</option>
<option value="Pegasus" >Pegasus</option>
<option value="Pervazive" > Pervazive</option>
<option value="Plantiga" >Plantiga</option>
<option value="Alumni X	"> Alumni X</option>
<option value="Protocol Fund" >Protocol Fund</option>
<option value="QuWare" > QuWare</option>
<option value="Retrievium" >Retrievium</option>
<option value="Semantix" >Semantix</option>
<option value="Eigen" >Eigen</option>
<option value="Spironix" >Spironix</option>
<option value="Swift Medical" >Swift Medical</option>
<option value="Synervoz" > Synervoz</option>
<option value="Tendermint" >Tendermint</option>
<option value="Tenstorrent" >Tenstorrent</option>
<option value="Landmine Boys" >Landmine Boys</option>
<option value="TREXO Robotics" >TREXO Robotics</option>
<option value="Vention" >Vention</option>
<option value="Vertex.AI" >Vertex.AI</option>
<option value="Xanadu" >Xanadu</option>
<option value="Yazabi" >Yazabi</option>
</select>

<button id="subven" onclick="startSearch()">Submit</button>

<div id="scheduleTable"></div>

</body>
</html>

<script type="text/javascript">

var allstrings = [];

function startSearch(){

	var name = $("#venture option:selected").val();
	//create the query
	//console.log(name);

	//var query = "SELECT * FROM Meetings WHERE LOWER(Venture_Name)=LOWER('" + name + "');";
	var query = "SELECT * FROM Meetings WHERE Venture_Name='" + name +"' OR Meeting_Number IS NULL ORDER BY Time_Start;" ;
	//this query doesn't query everything we actually need
	//we still need to query the track meetings and the general breaks/lunch etc...
	//console.log(query);
	//allstrings.push(query);

	$.ajax({
        type: 'post',
        url: 'processQuery.php',
        data: {
            sqlQuery: query
            //sqlInserts: allstrings
        },
        success: function( data ) {
        	//console.log("Here is the data retrived:");
            console.log(data);
            process(data);
            //console.log(allstrings);
            //alert("Complete");
        }
    });
}

function timeConverter(time){
	//var time = "16:30:00"; // your input

	time = time.split(':'); // convert to array
	
	// fetch
	var hours = Number(time[0]);
	var minutes = Number(time[1]);
	//var seconds = Number(time[2]);
	
	// calculate
	var timeValue = "" + ((hours >12) ? hours - 12 : hours);  // get hours
	timeValue += (minutes < 10) ? ":0" + minutes : ":" + minutes;  // get minutes
	//timeValue += (seconds < 10) ? ":0" + seconds : ":" + seconds;  // get seconds
	timeValue += (hours >= 12) ? " PM" : " AM";  // get AM/PM
	
	// show
	return timeValue;
}

function process(obj){

	var distable = "<table class='mytable'><thead><tr><th>Time</th><th>Agenda/Venture</th></tr></thead><tbody>"
	for (var i = 0; i < obj.length; i++) {
		var arr = obj[i];
		distable += "<tr>";
		distable += "<td>" + timeConverter(arr["Time_Start"]) + " - " + timeConverter(arr["Time_End"]) + "</td>";
		//inserting a small converter


		if (arr["Meeting_Number"]) {
			distable += "<td>Individual Meeting with " + arr["Lead_1"];
			for (var l = 2;l<4; l++) {
				var tt = "Lead_" + l;
				if (arr[tt]) {
					distable += "and "  + arr[tt];
				}else break;
			}

			distable += " in <b>Room " + arr["Room_Number"] + "</b></td>";
		}
		else if (arr["Description"]) {
			distable += "<td>" + arr["Description"] + "</td>";
		}
		else {
			distable += "<td>" + arr["Venture_Name"] + " Lead by: " + arr["Lead_1"] + "</td>";
		}
		
		/*for (var key in obj){
    		var value = obj[key];
			//we may not necessarily need to iterate over all o
    		//document.write(" " + key + ": " + value);
  		}*/
  		distable += "</tr>";
  		//document.write("<br> ");
	}
	distable += "</tbody></table>";
	$("#scheduleTable").append(distable);
}

</script>

<style type="text/css">

body {
	font-size: 12px;
	font-family: Arial, Helvetica, sans-serif;
}
	table.mytable {
		font-size: 12px;
		border: 1px solid #CCC; 
		font-family: Arial, Helvetica, sans-serif;
		margin-top: 5px;
	} 
	.mytable td {
		padding: 4px;
		margin: 3px;
		border: 1px solid #CCC;
	}
	.mytable th {
		background-color: #104E8B; 
		color: #FFF;
		font-weight: bold;
	}
</style>
